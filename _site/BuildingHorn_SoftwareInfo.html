<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Software Needs for Running the Horn Telescope &#8211; Digital Signal Processing in Radio Astronomy - Lessons Portal</title>
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Details of software installation needed for a horn telescope">
    <meta name="robots" content="all">
    <meta name="author" content="Pranav Sanghavi">
    <meta name="keywords" content="Horn Construction, Horn Operation">
    <link rel="canonical" href="http://localhost:4000/dspira-lessons/BuildingHorn_SoftwareInfo">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for Digital Signal Processing in Radio Astronomy - Lessons Portal" href="/dspira-lessons/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/dspira-lessons/css/style.css?202008201605" type="text/css">

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/v4-shims.min.css    ">
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Software Needs for Running the Horn Telescope">
    <meta property="og:description" content="Lots of lessons">
    <meta property="og:url" content="http://localhost:4000/BuildingHorn_SoftwareInfo">
    <meta property="og:site_name" content="Digital Signal Processing in Radio Astronomy - Lessons Portal">
    

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="@pranavsanghavi" />
        <meta name="twitter:creator" content="@pranavsanghavi" />
    
    <meta name="twitter:title" content="Software Needs for Running the Horn Telescope" />
    <meta name="twitter:description" content="Details of software installation needed for a horn telescope" />
    <meta name="twitter:url" content="http://localhost:4000/BuildingHorn_SoftwareInfo" />
    

    <!-- Icons -->
    <link rel="shortcut icon" href="/dspira-lessons/favicon.ico">
</head>

<body class="site animated fade-in-down">

  <div class="site-wrap">
    <header class="center site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="/dspira-lessons/" class="site-title button">Digital Signal Processing in Radio Astronomy - Lessons Portal</a>
      <nav class="site-nav">
        



    
    
    
    
        <a class="nav-link" href="/dspira-lessons/tour/">DSPIRA Guided Tour</a>
    

    


      </nav>
      <div class="clearfix"></div>
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        <div>
  
    
      
      <a class="button" href="/dspira-lessons/categories/horn-construction">Click to see all lessons in the Horn Construction module</a> 
    
      
      <a class="button" href="/dspira-lessons/categories/horn-operation">Click to see all lessons in the Horn Operation module</a> 
    
  
</div>






<div class="post-header mb2">
  <h1>Software Needs for Running the Horn Telescope</h1>
  <span class="post-meta">Jul 28, 2020 |</span>
  
  <span class="post-meta small">
  
    5 minute read
  
  </span>
</div>

<article class="post-content">
  <h2 id="installing-the-software-needed-to-run-the-spectrometer-on-a-computer-that-is-using-ubuntu-2004">Installing the Software Needed to Run the Spectrometer on a Computer That is Using Ubuntu 20.04</h2>

<p>Complete the following steps as needed:</p>

<h4 id="a-how-to-partition-a-hard-drive-for-ubuntu-2004-alongside-windows-10">A. How to Partition a Hard Drive for Ubuntu 20.04 Alongside Windows 10</h4>

<ol>
  <li>
    <p><a href="http://releases.ubuntu.com/20.04/">Download Ubuntu Desktop 20.04 ISO onto hard drive in Windows.</a> You want to choose the Desktop version. It will take some time to download this file.</p>
  </li>
  <li>
    <p>Install a 32 GB or larger flash drive in the usb port.</p>
  </li>
  <li>
    <p>Download <em>BalenaEtcher</em> for Windows and install it if you don’t already have it.</p>
  </li>
  <li>
    <p>Run <em>BalenaEtcher</em>. Choose the Ubuntu20.04.iso file as the image and the flash drive as the target. It will take some time for this to run.</p>
  </li>
  <li>
    <p>Before installing Ubuntu on the hard disk, you need to partition the hard disk in Windows.</p>

    <p>Open a Command Prompt window with admin rights:</p>
    <ul>
      <li>In the Cortana search field, type in <code class="highlighter-rouge">Command Prompt</code>, or just CMD.</li>
      <li>Right click the top result, and select <code class="highlighter-rouge">Run as Administrator</code>.</li>
      <li>Click <code class="highlighter-rouge">Yes</code> on the popup to allow the app to make changes to your device.</li>
    </ul>
  </li>
  <li>
    <p>Enter the command <code class="highlighter-rouge">diskmgmt.msc</code> to open the Disk Management utility.</p>
  </li>
  <li>
    <p>Select the Windows partition, usually the C: volume. Right-click on this partition and select the <code class="highlighter-rouge">Shrink Volume</code> option in order to reduce the partition size.</p>
  </li>
  <li>
    <p>Wait for the system to collect partition size data; then add the desired amount of space you want to shrink, and hit in the ‘Shrink’ button. The partition size to shrink by (which is the amount that will be allotted to Ubuntu) should be a minimum of 50 GB, and we recommend 100 GB or more, depending on the size of your hard drive.</p>
  </li>
</ol>

<p>After the shrink process completes, a new unallocated space will be present in your drive. We’ll use this free space to install Ubuntu alongside Windows</p>

<h4 id="b-install-ubuntu-2004-alongside-with-windows">B. Install Ubuntu 20.04 Alongside with Windows</h4>

<ol>
  <li>
    <p>Place the bootable flash drive in the USB port, and reboot the machine, holding down the bootable key (F12) in order to boot from the Ubuntu USB bootable image.</p>
  </li>
  <li>
    <p>On the first installation screen, select <code class="highlighter-rouge">Install Ubuntu</code> and hit Enter to start the installation process. This will complete the installation process, unless an error message appears.</p>
  </li>
  <li>
    <p>IF AN ERROR APPEARS REGARDING DEVICE ENCRYPTION, you probably need to disable device encryption in Windows. This is known as Bitlocker. To disable it, complete the following:</p>

    <ul>
      <li>For most Windows systems, the following can be followed to turn off encryption:
        <ul>
          <li>Boot up the computer in Windows.</li>
          <li>Open <code class="highlighter-rouge">Settings</code>.</li>
          <li>Click on <code class="highlighter-rouge">Update &amp; Security</code>.</li>
          <li>Click on <code class="highlighter-rouge">Device encryption</code>.</li>
          <li>Under the “Device encryption” section, click the <code class="highlighter-rouge">Turn off</code> button.</li>
          <li>Wait until Windows 10 has completed un-encrypting the hard drive before you turn off Windows 10 and start the disk boot and Ubuntu install.</li>
        </ul>
      </li>
      <li>
        <p>For some Windows 10 Home system, the Bitlocker or Device encryption is not visible. Complete the following to turn off encryption from a command line.</p>

        <ul>
          <li>
            <p>In Windows from the <code class="highlighter-rouge">Start Menu</code>, click the <code class="highlighter-rouge">Windows PowerShell</code> folder and tap <code class="highlighter-rouge">Windows PowerShell</code>.</p>
          </li>
          <li>
            <p>A command line window will open up. From the Powershell command line, type <code class="highlighter-rouge">Disable-BitLocker -MountPoint C:</code> and hit Enter.</p>
          </li>
        </ul>
      </li>
      <li>Another option for systems with Windows 10 Home is the following:
        <ul>
          <li>In the <code class="highlighter-rouge">Start Menu</code> search box, type <code class="highlighter-rouge">Services</code>. Then scroll to <code class="highlighter-rouge">Bitlocker</code>.</li>
          <li>Open it, or view its <code class="highlighter-rouge">Properties</code>, and then <code class="highlighter-rouge">Disable</code> it.</li>
        </ul>
      </li>
      <li>After disabling the encryption in Windows, repeat steps 1 and 2 above. Be sure to wait until Windows 10 has completed un-encrypting the hard drive before you turn off Windows 10 and start the disk boot and Ubuntu install.</li>
    </ul>
  </li>
</ol>

<h4 id="c-install-gnuradio">C. Install Gnuradio</h4>

<ol>
  <li>
    <p>Open a terminal window.</p>
  </li>
  <li>
    <p>Type and enter <code class="highlighter-rouge">sudo apt update</code></p>
  </li>
  <li>
    <p>Type and enter <code class="highlighter-rouge">sudo apt upgrade</code></p>
  </li>
  <li>
    <p>Type and enter <code class="highlighter-rouge">sudo apt install gnuradio</code></p>
  </li>
  <li>
    <p>You may need to respond ‘Y’ to a few prompts before installation is complete.</p>
  </li>
</ol>

<h4 id="d-install-gr-radio_astro">D. Install gr-radio_astro</h4>

<p>This will install the spectrometer program <em>spectrometer_w_cal.grc</em>.</p>

<ol>
  <li>
    <p>Open a terminal window in Ubuntu.</p>
  </li>
  <li>
    <p>Install gnuradio external python dependencies and SDR drivers by typing the following:
<code class="highlighter-rouge">sudo apt install gnuradio gr-osmosdr airspy python3-h5py python3-ephem</code>, and hit Enter.</p>
  </li>
  <li>
    <p>Also install the following package: <code class="highlighter-rouge">sudo apt install git cmake liborc-0.4-dev</code></p>
  </li>
  <li>
    <p>To clone the repository: in the terminal, type and Enter: <code class="highlighter-rouge">git clone https://github.com/WVURAIL/gr-radio_astro.git</code></p>
  </li>
  <li>
    <p>Switch to the gr-radio_astro directory: <code class="highlighter-rouge">cd gr-radio_astro</code></p>
  </li>
  <li>
    <p>Switch to the gr-radio_astro 3.8 branch by typing: <code class="highlighter-rouge">git checkout gr38</code></p>
  </li>
  <li>
    <p>Make a build directory: <code class="highlighter-rouge">mkdir build</code>, and then move to it: <code class="highlighter-rouge">cd build</code></p>
  </li>
  <li>
    <p>Then run the following in the build directory:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cmake ..
sudo make
sudo make install
</code></pre></div>    </div>
    <p><strong>Additional Steps for setting the proper Python environment:</strong></p>
  </li>
  <li>
    <p>Open a terminal window.</p>
  </li>
  <li>
    <p>Make sure you are at the home directory (type and Enter <code class="highlighter-rouge">cd</code> ). Then type <code class="highlighter-rouge">gedit .bashrc</code> to open the <em>.bashrc</em> file in an editor.</p>
  </li>
  <li>
    <p>Scroll to the very bottom of this file, add a blank line, and then copy and paste the following code: <code class="highlighter-rouge">export PYTHONPATH=/usr/local/lib/python3/dist-packages:/usr/local/lib/python3.8/dist-packages:$PYTHONPATH</code></p>
  </li>
  <li>
    <p>Save and close (x in upper right corner).</p>
  </li>
  <li>
    <p>Go to the following by typing: <code class="highlighter-rouge">cd /usr/local/lib/python3.8/dist-packages</code></p>
  </li>
  <li>
    <p>Enter <code class="highlighter-rouge">ls</code></p>
  </li>
  <li>
    <p>If the folder <code class="highlighter-rouge">radio_astro</code> exists, delete it by typing: <code class="highlighter-rouge">sudo rm -rf radio_astro</code> . If nothing shows up after typing <code class="highlighter-rouge">ls</code>, then everything is fine.</p>
  </li>
</ol>

<p><strong>Check that the Installation was Successful</strong></p>

<ol>
  <li>Run the program in Gnuradio:
    <ul>
      <li>In a terminal window type <code class="highlighter-rouge">gnuradio-companion</code></li>
      <li>
        <p>Open the <em>spectrometer_w_cal.grc</em> program as follows:</p>

        <p><code class="highlighter-rouge">File --&gt; Open --&gt; gr-radio_astros --&gt; examples --&gt; *spectrometer_w_cal.grc* </code></p>
      </li>
      <li>Plug an Airspy radio, with the LNA attached, into the USB port. Run the program by hitting the start triangle (“execute the flowgraph”) on the menu bar at top. If no errors occur, you are all set!</li>
    </ul>
  </li>
</ol>

<h4 id="e-how-to-update-files-from-the-gr-radio_astro-gr38-repository">E. How to Update files from the gr-radio_astro gr38 Repository</h4>

<ol>
  <li>
    <p>Switch to the <em>gr-radio_astro</em> folder on your computer: <code class="highlighter-rouge">cd gr-radio_astro</code></p>
  </li>
  <li>
    <p>To check to see if you are in the gr38 branch, enter <code class="highlighter-rouge">git status</code>. The descriptor “On branch gr38” should appear at the top of the displayed text.</p>

    <p>To switch to the gr38 branch, type <code class="highlighter-rouge">git checkout gr38</code>. Then type <code class="highlighter-rouge">git status</code> to check.</p>
  </li>
  <li>
    <p>Type <code class="highlighter-rouge">git pull</code>. This should update your gr-radio_astro files on your computer.</p>
  </li>
  <li>
    <p>Run the <em>spectrometer_w_cal.grc</em> program in Gnuradio:</p>
    <ul>
      <li>In a terminal window type <code class="highlighter-rouge">gnuradio-companion</code></li>
      <li>Close any pre-existing <em>spectrometer_w_cal.grc</em> program that may already be loaded in the Gnuradio program.</li>
      <li>
        <p>Open the new <em>spectrometer_w_cal.grc</em> program that is in the updated gr-radio_astro folder:</p>

        <p><code class="highlighter-rouge">File --&gt; Open --&gt; gr-radio_astros --&gt; examples --&gt; spectrometer_w_cal.grc</code></p>
      </li>
      <li>Make sure an Airspy radio is plugged into a USB port. Execute the program to check that it is updated successfully.</li>
    </ul>
  </li>
</ol>


</article>


  <div class="share-page">
  <div class="share-links">
    Share this post!

    
      <a class="fa fa-facebook" href="https://facebook.com/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2FBuildingHorn_SoftwareInfo" rel="nofollow" target="_blank" title="Share on Facebook"></a>
    

    
      <a class="fa fa-twitter" href="https://twitter.com/intent/tweet?text=Software+Needs+for+Running+the+Horn+Telescope&amp;url=http%3A%2F%2Flocalhost%3A4000%2FBuildingHorn_SoftwareInfo" rel="nofollow" target="_blank" title="Share on Twitter"></a>
    

    

    
      <a class="fa fa-linkedin" href="http://www.linkedin.com/shareArticle?url=http%3A%2F%2Flocalhost%3A4000%2FBuildingHorn_SoftwareInfo&amp;title=Software+Needs+for+Running+the+Horn+Telescope" rel="nofollow" target="_blank" title="Share on LinkedIn"></a>
    

    

    
      <a class="fa fa-tumblr" href="http://www.tumblr.com/share/link?url=http%3A%2F%2Flocalhost%3A4000%2FBuildingHorn_SoftwareInfo&amp;name=Software+Needs+for+Running+the+Horn+Telescope" rel="nofollow" target="_blank" title="Share on Tumblr"></a>
    

    
      <a class="fa fa-reddit" href="http://reddit.com/submit?url=http%3A%2F%2Flocalhost%3A4000%2FBuildingHorn_SoftwareInfo&amp;title=Software+Needs+for+Running+the+Horn+Telescope" rel="nofollow" target="_blank" title="Share on Reddit"></a>
    

    

    
      <a class="fa fa-hacker-news" onclick="parent.postMessage('submit','*')" href="https://news.ycombinator.com/submitlink?u=http%3A%2F%2Flocalhost%3A4000%2FBuildingHorn_SoftwareInfo&amp;t=Software+Needs+for+Running+the+Horn+Telescope" rel="nofollow" target="_blank" title="Share on Hacker News"></a>
    
  </div>
</div>






<div>
  <h4>Appropriate for:</h4>
  
    
        
        <a class="button" href="/dspira-lessons/tags/school-teachers">School-Teachers
        </a> 
    
        
        <a class="button" href="/dspira-lessons/tags/students">Students
        </a> 
    
        
        <a class="button" href="/dspira-lessons/tags/hobbyists">Hobbyists
        </a> 
    
  
</div>



  <h3 class="related-post-title">Related Lessons</h3>
  <ul class="related-posts">
    
    <li>
      <a href="/dspira-lessons/AssemblingtheCAN" class="post-link">
          Detailed Instructions for Assembling the CAN
      </a>
    </li>
    
    <li>
      <a href="/dspira-lessons/dsplab-fourier2/" class="post-link">
          Digital Signal Processsing using GNURadio - Fourier Analysis and Radio Astronomy
      </a>
    </li>
    
    <li>
      <a href="/dspira-lessons/dsplab-filters/" class="post-link">
          Digital Signal Processsing using GNURadio - Digital Filter
      </a>
    </li>
    
    <li>
      <a href="/dspira-lessons/dsplab-fourier1/" class="post-link">
          Digital Signal Processsing using GNURadio - Fourier Analysis
      </a>
    </li>
    
    <li>
      <a href="/dspira-lessons/dsplab-sdr/" class="post-link">
          Digital Signal Processsing using GNURadio - Software Defined Radio
      </a>
    </li>
    
    <li>
      <a href="/dspira-lessons/dsplab-intro/" class="post-link">
          Digital Signal Processsing using GNURadio - Introductory Lab
      </a>
    </li>
    
    <li>
      <a href="/dspira-lessons/dsp" class="post-link">
          Digital Signal Processsing
      </a>
    </li>
    
    <li>
      <a href="/dspira-lessons/HornOperation_computerSystems" class="post-link">
          Computer and Software Needs for the Horn Telescope Spectrometer
      </a>
    </li>
    
    <li>
      <a href="/dspira-lessons/DetailedLNAInstructions" class="post-link">
          Detailed LNA Construction Instructions
      </a>
    </li>
    
    <li>
      <a href="/dspira-lessons/Install_Ubuntu_spectrometer_onFlashdrive" class="post-link">
          How to Install Ubuntu 20.04 with spectrometer_w_cal.grc on Bootable Flashdrive
      </a>
    </li>
    
  </ul>





      </div>
    </div>
  </div>
  <footer class="left">
  <div class="measure">
    <div class="left" style="width: 80%;">
      <small style="padding: 1%;">
        &copy;2020  &nbsp; &nbsp;  <a class="button" href="/dspira-lessons/about/">About DSPIRA</a><div style="padding: 2%; display: inline-block;"><div  style="float: left; width: 3%;"><img src="/dspira-lessons/images/gb.svg"></div><div  style="float: left; width: 3%;"><img src="/dspira-lessons/images/nsf.svg"></div><div style="float: left; width: 20%;"><img src="/dspira-lessons/images/wvu.svg"></div></div>
      </small>
    </div>
    
      <div class="social-icons right">
    
  
    <a class="fab fa-github" href="https://github.com/wvurail" target="_blank"></a>
  
  
    <a class="fab fa-twitter" href="https://twitter.com/pranavsanghavi" target="_blank"></a>
  
  
  
    <a class="fas fa-envelope" href="mailto:wvurail@gmail.com"></a>
  
  <a class="fas fa-rss" href="/dspira-lessons/feed.xml" target="_blank"></a>
</div>
<div class="clearfix"></div>

    
  </div>
</footer>
<script type="text/javascript">
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/dspira-lessons/sw.js")
    }
</script>

  <style>
    .videoWrapper {
        position: relative;
        padding-bottom: 56.333%;
        height: 0;
        background: black;
    }
    .videoWrapper iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: 0;
    }    
    </style>
    
    <script>
    function get_youtube_id(url) {
        var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
        return (url.match(p)) ? RegExp.$1 : false;
    }
    function vimeo_embed(url,el) {
        var id = false;
        $.ajax({
          url: 'https://vimeo.com/api/oembed.json?url='+url,
          async: true,
          success: function(response) {
            if(response.video_id) {
              id = response.video_id;
              if(url.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
              if(url.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
              var theInnerHTML = '<div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+id+'/?byline=0&title=0&portrait=0';
              if(autoplay==1) theInnerHTML += '&autoplay=1';
              if(loop==1) theInnerHTML += '&loop=1';
              theInnerHTML += '" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>'; 
              el.innerHTML = theInnerHTML;
            }
          }
        });
    }
    function video_embed() {
        var p = document.getElementsByTagName('p');
        for(var i = 0; i < p.length; i++) {
            //check if this is an external url (that starts with https:// or http://
            if (p[i].innerHTML.indexOf("http://") == 0 ||
                p[i].innerHTML.indexOf("https://") == 0) {
                var youtube_id = get_youtube_id(p[i].innerHTML);
                if(youtube_id) {
                    if(p[i].innerHTML.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                    if(p[i].innerHTML.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                    var theInnerHTML = '<div class="videoWrapper"><iframe width="720" height="420" src="https://www.youtube.com/embed/' + youtube_id + '?rel=0&showinfo=0';
                    if(autoplay==1) theInnerHTML += '&autoplay=1';
                    if(loop==1) theInnerHTML += '&loop=1&playlist='+youtube_id+'&version=3';
                    if(p[i].innerHTML.indexOf('start=') !== -1) theInnerHTML += '&start='+p[i].innerHTML.substring(p[i].innerHTML.indexOf('start=')+6);
                    theInnerHTML += '" frameborder="0" allowfullscreen></iframe></div>';
                    p[i].innerHTML = theInnerHTML;
                }
                if(p[i].innerHTML.indexOf('vimeo.com') !== -1) {
                    //ask vimeo for the id and place the embed
                    vimeo_embed(p[i].innerHTML,p[i]);
                }
            }
        }
    }
    video_embed();
    
    function mp3_embed() {
        var p = document.getElementsByTagName('p');
        for(var i = 0; i < p.length; i++) {
            if(p[i].innerHTML.indexOf('.mp3') !== -1) {
                var str = p[i].innerHTML.split('?');
                if(str.length == 1) str[1] = '';
                var str1 = str[1];
                str1 = str1.replace('&','').replace('&','');
                str1 = str1.replace('autoplay=1','').replace('autoplay=0','');
                str1 = str1.replace('loop=1','').replace('loop=0','');
                str1 = str1.replace('controls=0','').replace('controls=1','');
    
                if (str[0].lastIndexOf('.mp3', str[0].length - 4) === str[0].length - 4 && str1.length == 0) {
                    if(str[1].indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                    if(str[1].indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                    if(str[1].indexOf('controls=0') !== -1) var controls=0; else var controls=1;
                    var newInnerHTML = '<audio';
                    if(autoplay==1) newInnerHTML += ' autoplay';
                    if(loop==1) newInnerHTML += ' loop';
                    if(controls==1) newInnerHTML += ' controls';
                    newInnerHTML += '><source src="'+str[0]+'" type="audio/mpeg">Your browser does not support the audio element.</audio>';
                    p[i].innerHTML = newInnerHTML;
                }
            }
        }
    }
    mp3_embed();
    </script>
    
</body>
</html>
